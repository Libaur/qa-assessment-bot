var yt=Object.defineProperty;var Ct=(s,e,t)=>e in s?yt(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var p=(s,e,t)=>Ct(s,typeof e!="symbol"?e+"":e,t);import wt from"path";import _t from"os";import bt from"crypto";const Se=new Map;function vt(s){const e=Array.isArray(s)?s:[s],t=e.join(","),r=Se.get(t)??(()=>{const n=Ve(e),i=It(n);return Se.set(t,i),i})();return n=>r(n)}function Ve(s){return Array.isArray(s)?s.map(e=>e.split(":")):[s.split(":")]}function It(s){const e=s.flatMap(n=>kt(n,We(n))),t=Mt(e),r=St(t);return n=>!!r(n.update,n)}function We(s){const e=se,t=[s].flatMap(r=>{const[n,i,o]=r;if(!(n in xe))return[r];if(!n&&!i&&!o)return[r];const u=xe[n].map(l=>[l,i,o]);return i===void 0||i in le&&(i||o)?u:u.filter(([l])=>{var h;return!!((h=e[l])!=null&&h[i])})}).flatMap(r=>{const[n,i,o]=r;if(!(i in le))return[r];if(!i&&!o)return[r];const u=le[i].map(l=>[n,l,o]);return o===void 0?u:u.filter(([,l])=>{var h,d;return!!((d=(h=e[n])==null?void 0:h[l])!=null&&d[o])})});if(t.length===0)throw new Error(`Shortcuts in '${s.join(":")}' do not expand to any valid filter query`);return t}function kt(s,e){if(e.length===0)throw new Error("Empty filter query given");const t=e.map(Tt).filter(r=>r!==!0);if(t.length===0)return e;throw t.length===1?new Error(t[0]):new Error(`Invalid filter query '${s.join(":")}'. There are ${t.length} errors after expanding the contained shortcuts: ${t.join("; ")}`)}function Tt(s){const[e,t,r,...n]=s;if(e===void 0)return"Empty filter query given";if(!(e in se)){const c=Object.keys(se);return`Invalid L1 filter '${e}' given in '${s.join(":")}'. Permitted values are: ${c.map(u=>`'${u}'`).join(", ")}.`}if(t===void 0)return!0;const i=se[e];if(!(t in i)){const c=Object.keys(i);return`Invalid L2 filter '${t}' given in '${s.join(":")}'. Permitted values are: ${c.map(u=>`'${u}'`).join(", ")}.`}if(r===void 0)return!0;const o=i[t];if(!(r in o)){const c=Object.keys(o);return`Invalid L3 filter '${r}' given in '${s.join(":")}'. ${c.length===0?`No further filtering is possible after '${e}:${t}'.`:`Permitted values are: ${c.map(u=>`'${u}'`).join(", ")}.`}`}return n.length===0?!0:`Cannot filter further than three levels, ':${n.join(":")}' is invalid!`}function Mt(s){const e={};for(const[t,r,n]of s){const i=e[t]??(e[t]={});if(r!==void 0){const o=i[r]??(i[r]=new Set);n!==void 0&&o.add(n)}}return e}function he(s,e){return(t,r)=>s(t,r)||e(t,r)}function Ee(s,e){return(t,r)=>{const n=s(t,r);return n&&e(n,r)}}function Ae(s){return(e,t)=>s(e,t)!=null}function St(s){const e=Object.entries(s).map(([t,r])=>{const n=o=>o[t],i=Object.entries(r).map(([o,c])=>{const u=h=>h[o],l=Array.from(c).map(h=>h==="me"?(m,b)=>{const f=b.me.id;return Fe(m,g=>g.id===f)}:m=>Fe(m,b=>b[h]||b.type===h));return l.length===0?Ae(u):Ee(u,l.reduce(he))});return i.length===0?Ae(n):Ee(n,i.reduce(he))});if(e.length===0)throw new Error("Cannot create filter function for empty query");return e.reduce(he)}function Fe(s,e){const t=r=>r!=null&&e(r);return Array.isArray(s)?s.some(t):t(s)}const Re={mention:{},hashtag:{},cashtag:{},bot_command:{},url:{},email:{},phone_number:{},bold:{},italic:{},underline:{},strikethrough:{},spoiler:{},blockquote:{},expandable_blockquote:{},code:{},pre:{},text_link:{},text_mention:{},custom_emoji:{}},me={me:{},is_bot:{},is_premium:{},added_to_attachment_menu:{}},Et={user:{},hidden_user:{},chat:{},channel:{}},At={is_video:{},is_animated:{},premium_animation:{}},fe={emoji:{},custom_emoji:{},paid:{}},Je={forward_origin:Et,is_topic_message:{},is_automatic_forward:{},business_connection_id:{},text:{},animation:{},audio:{},document:{},paid_media:{},photo:{},sticker:At,story:{},video:{},video_note:{},voice:{},contact:{},dice:{},game:{},poll:{},venue:{},location:{},entities:Re,caption_entities:Re,caption:{},effect_id:{},has_media_spoiler:{},new_chat_title:{},new_chat_photo:{},delete_chat_photo:{},message_auto_delete_timer_changed:{},pinned_message:{},invoice:{},proximity_alert_triggered:{},chat_background_set:{},giveaway_created:{},giveaway:{only_new_members:{},has_public_winners:{}},giveaway_winners:{only_new_members:{},was_refunded:{}},giveaway_completed:{},video_chat_scheduled:{},video_chat_started:{},video_chat_ended:{},video_chat_participants_invited:{},web_app_data:{}},ee={...Je,new_chat_members:me,left_chat_member:me,group_chat_created:{},supergroup_chat_created:{},migrate_to_chat_id:{},migrate_from_chat_id:{},successful_payment:{},refunded_payment:{},users_shared:{},chat_shared:{},connected_website:{},write_access_allowed:{},passport_data:{},boost_added:{},forum_topic_created:{},forum_topic_edited:{name:{},icon_custom_emoji_id:{}},forum_topic_closed:{},forum_topic_reopened:{},general_forum_topic_hidden:{},general_forum_topic_unhidden:{},sender_boost_count:{}},Pe={...Je,channel_chat_created:{}},Ft={can_reply:{},is_enabled:{}},Rt={old_reaction:fe,new_reaction:fe},Pt={reactions:fe},Nt={data:{},game_short_name:{}},Ne={from:me},se={message:ee,edited_message:ee,channel_post:Pe,edited_channel_post:Pe,business_connection:Ft,business_message:ee,edited_business_message:ee,deleted_business_messages:{},inline_query:{},chosen_inline_result:{},callback_query:Nt,shipping_query:{},pre_checkout_query:{},poll:{},poll_answer:{},my_chat_member:Ne,chat_member:Ne,chat_join_request:{},message_reaction:Rt,message_reaction_count:Pt,chat_boost:{},removed_chat_boost:{},purchased_paid_media:{}},xe={"":["message","channel_post"],msg:["message","channel_post"],edit:["edited_message","edited_channel_post"]},le={"":["entities","caption_entities"],media:["photo","video"],file:["photo","animation","audio","document","video","video_note","voice","sticker"]},S={filterQuery(s){const e=vt(s);return t=>e(t)},text(s){const e=S.filterQuery([":text",":caption"]),t=P(s);return r=>{if(!e(r))return!1;const n=r.message??r.channelPost,i=n.text??n.caption;return N(r,i,t)}},command(s){const e=S.filterQuery(":entities:bot_command"),t=new Set,r=new Set;return ie(s).forEach(n=>{if(n.startsWith("/"))throw new Error(`Do not include '/' when registering command handlers (use '${n.substring(1)}' not '${n}')`);(n.includes("@")?t:r).add(n)}),n=>{if(!e(n))return!1;const i=n.message??n.channelPost,o=i.text??i.caption;return i.entities.some(c=>{if(c.type!=="bot_command"||c.offset!==0)return!1;const u=o.substring(1,c.length);if(r.has(u)||t.has(u))return n.match=o.substring(u.length+1).trimStart(),!0;const l=u.indexOf("@");if(l===-1)return!1;const h=u.substring(l+1).toLowerCase(),d=n.me.username.toLowerCase();if(h!==d)return!1;const m=u.substring(0,l);return r.has(m)?(n.match=o.substring(u.length+1).trimStart(),!0):!1})}},reaction(s){const e=S.filterQuery("message_reaction"),t=typeof s=="string"?[{type:"emoji",emoji:s}]:(Array.isArray(s)?s:[s]).map(o=>typeof o=="string"?{type:"emoji",emoji:o}:o),r=new Set(t.filter(o=>o.type==="emoji").map(o=>o.emoji)),n=new Set(t.filter(o=>o.type==="custom_emoji").map(o=>o.custom_emoji_id)),i=t.some(o=>o.type==="paid");return o=>{if(!e(o))return!1;const{old_reaction:c,new_reaction:u}=o.messageReaction;for(const l of u){let h=!1;if(l.type==="emoji"){for(const d of c)if(d.type==="emoji"&&d.emoji===l.emoji){h=!0;break}}else if(l.type==="custom_emoji"){for(const d of c)if(d.type==="custom_emoji"&&d.custom_emoji_id===l.custom_emoji_id){h=!0;break}}else if(l.type==="paid"){for(const d of c)if(d.type==="paid"){h=!0;break}}if(!h)if(l.type==="emoji"){if(r.has(l.emoji))return!0}else if(l.type==="custom_emoji"){if(n.has(l.custom_emoji_id))return!0}else if(l.type==="paid"){if(i)return!0}else return!0}return!1}},chatType(s){const e=new Set(ie(s));return t=>{var r;return((r=t.chat)==null?void 0:r.type)!==void 0&&e.has(t.chat.type)}},callbackQuery(s){const e=S.filterQuery("callback_query:data"),t=P(s);return r=>e(r)&&N(r,r.callbackQuery.data,t)},gameQuery(s){const e=S.filterQuery("callback_query:game_short_name"),t=P(s);return r=>e(r)&&N(r,r.callbackQuery.game_short_name,t)},inlineQuery(s){const e=S.filterQuery("inline_query"),t=P(s);return r=>e(r)&&N(r,r.inlineQuery.query,t)},chosenInlineResult(s){const e=S.filterQuery("chosen_inline_result"),t=P(s);return r=>e(r)&&N(r,r.chosenInlineResult.result_id,t)},preCheckoutQuery(s){const e=S.filterQuery("pre_checkout_query"),t=P(s);return r=>e(r)&&N(r,r.preCheckoutQuery.invoice_payload,t)},shippingQuery(s){const e=S.filterQuery("shipping_query"),t=P(s);return r=>e(r)&&N(r,r.shippingQuery.invoice_payload,t)}},k=class k{constructor(e,t,r){p(this,"update");p(this,"api");p(this,"me");p(this,"match");this.update=e,this.api=t,this.me=r}get message(){return this.update.message}get editedMessage(){return this.update.edited_message}get channelPost(){return this.update.channel_post}get editedChannelPost(){return this.update.edited_channel_post}get businessConnection(){return this.update.business_connection}get businessMessage(){return this.update.business_message}get editedBusinessMessage(){return this.update.edited_business_message}get deletedBusinessMessages(){return this.update.deleted_business_messages}get messageReaction(){return this.update.message_reaction}get messageReactionCount(){return this.update.message_reaction_count}get inlineQuery(){return this.update.inline_query}get chosenInlineResult(){return this.update.chosen_inline_result}get callbackQuery(){return this.update.callback_query}get shippingQuery(){return this.update.shipping_query}get preCheckoutQuery(){return this.update.pre_checkout_query}get poll(){return this.update.poll}get pollAnswer(){return this.update.poll_answer}get myChatMember(){return this.update.my_chat_member}get chatMember(){return this.update.chat_member}get chatJoinRequest(){return this.update.chat_join_request}get chatBoost(){return this.update.chat_boost}get removedChatBoost(){return this.update.removed_chat_boost}get purchasedPaidMedia(){return this.update.purchased_paid_media}get msg(){var e;return this.message??this.editedMessage??this.channelPost??this.editedChannelPost??this.businessMessage??this.editedBusinessMessage??((e=this.callbackQuery)==null?void 0:e.message)}get chat(){var e;return(e=this.msg??this.deletedBusinessMessages??this.messageReaction??this.messageReactionCount??this.myChatMember??this.chatMember??this.chatJoinRequest??this.chatBoost??this.removedChatBoost)==null?void 0:e.chat}get senderChat(){var e;return(e=this.msg)==null?void 0:e.sender_chat}get from(){var e,t,r,n;return((r=this.businessConnection??this.messageReaction??((t=((e=this.chatBoost)==null?void 0:e.boost)??this.removedChatBoost)==null?void 0:t.source))==null?void 0:r.user)??((n=this.callbackQuery??this.msg??this.inlineQuery??this.chosenInlineResult??this.shippingQuery??this.preCheckoutQuery??this.myChatMember??this.chatMember??this.chatJoinRequest??this.purchasedPaidMedia)==null?void 0:n.from)}get msgId(){var e,t,r;return((e=this.msg)==null?void 0:e.message_id)??((t=this.messageReaction)==null?void 0:t.message_id)??((r=this.messageReactionCount)==null?void 0:r.message_id)}get chatId(){var e,t;return((e=this.chat)==null?void 0:e.id)??((t=this.businessConnection)==null?void 0:t.user_chat_id)}get inlineMessageId(){var e,t;return((e=this.callbackQuery)==null?void 0:e.inline_message_id)??((t=this.chosenInlineResult)==null?void 0:t.inline_message_id)}get businessConnectionId(){var e,t,r;return((e=this.msg)==null?void 0:e.business_connection_id)??((t=this.businessConnection)==null?void 0:t.id)??((r=this.deletedBusinessMessages)==null?void 0:r.business_connection_id)}entities(e){const t=this.msg;if(t===void 0)return[];const r=t.text??t.caption;if(r===void 0)return[];let n=t.entities??t.caption_entities;if(n===void 0)return[];if(e!==void 0){const i=new Set(ie(e));n=n.filter(o=>i.has(o.type))}return n.map(i=>({...i,text:r.substring(i.offset,i.offset+i.length)}))}reactions(){const e=[],t=[],r=[],n=[],i=[],o=[],c=[],u=[];let l=!1,h=!1;const d=this.messageReaction;if(d!==void 0){const{old_reaction:m,new_reaction:b}=d;for(const f of b)f.type==="emoji"?e.push(f.emoji):f.type==="custom_emoji"?i.push(f.custom_emoji_id):f.type==="paid"&&(l=h=!0);for(const f of m)f.type==="emoji"?n.push(f.emoji):f.type==="custom_emoji"?u.push(f.custom_emoji_id):f.type==="paid"&&(h=!1);t.push(...e),o.push(...i);for(let f=0;f<n.length;f++){const g=t.length;if(g===0)break;const y=n[f];for(let C=0;C<g;C++)if(y===t[C]){r.push(y),n.splice(f,1),t.splice(C,1),f--;break}}for(let f=0;f<u.length;f++){const g=o.length;if(g===0)break;const y=u[f];for(let C=0;C<g;C++)if(y===o[C]){c.push(y),u.splice(f,1),o.splice(C,1),f--;break}}}return{emoji:e,emojiAdded:t,emojiKept:r,emojiRemoved:n,customEmoji:i,customEmojiAdded:o,customEmojiKept:c,customEmojiRemoved:u,paid:l,paidAdded:h}}has(e){return k.has.filterQuery(e)(this)}hasText(e){return k.has.text(e)(this)}hasCommand(e){return k.has.command(e)(this)}hasReaction(e){return k.has.reaction(e)(this)}hasChatType(e){return k.has.chatType(e)(this)}hasCallbackQuery(e){return k.has.callbackQuery(e)(this)}hasGameQuery(e){return k.has.gameQuery(e)(this)}hasInlineQuery(e){return k.has.inlineQuery(e)(this)}hasChosenInlineResult(e){return k.has.chosenInlineResult(e)(this)}hasPreCheckoutQuery(e){return k.has.preCheckoutQuery(e)(this)}hasShippingQuery(e){return k.has.shippingQuery(e)(this)}reply(e,t,r){return this.api.sendMessage(a(this.chatId,"sendMessage"),e,{business_connection_id:this.businessConnectionId,...t},r)}forwardMessage(e,t,r){return this.api.forwardMessage(e,a(this.chatId,"forwardMessage"),a(this.msgId,"forwardMessage"),t,r)}forwardMessages(e,t,r,n){return this.api.forwardMessages(e,a(this.chatId,"forwardMessages"),t,r,n)}copyMessage(e,t,r){return this.api.copyMessage(e,a(this.chatId,"copyMessage"),a(this.msgId,"copyMessage"),t,r)}copyMessages(e,t,r,n){return this.api.copyMessages(e,a(this.chatId,"copyMessages"),t,r,n)}replyWithPhoto(e,t,r){return this.api.sendPhoto(a(this.chatId,"sendPhoto"),e,{business_connection_id:this.businessConnectionId,...t},r)}replyWithAudio(e,t,r){return this.api.sendAudio(a(this.chatId,"sendAudio"),e,{business_connection_id:this.businessConnectionId,...t},r)}replyWithDocument(e,t,r){return this.api.sendDocument(a(this.chatId,"sendDocument"),e,{business_connection_id:this.businessConnectionId,...t},r)}replyWithVideo(e,t,r){return this.api.sendVideo(a(this.chatId,"sendVideo"),e,{business_connection_id:this.businessConnectionId,...t},r)}replyWithAnimation(e,t,r){return this.api.sendAnimation(a(this.chatId,"sendAnimation"),e,{business_connection_id:this.businessConnectionId,...t},r)}replyWithVoice(e,t,r){return this.api.sendVoice(a(this.chatId,"sendVoice"),e,{business_connection_id:this.businessConnectionId,...t},r)}replyWithVideoNote(e,t,r){return this.api.sendVideoNote(a(this.chatId,"sendVideoNote"),e,{business_connection_id:this.businessConnectionId,...t},r)}replyWithMediaGroup(e,t,r){return this.api.sendMediaGroup(a(this.chatId,"sendMediaGroup"),e,{business_connection_id:this.businessConnectionId,...t},r)}replyWithLocation(e,t,r,n){return this.api.sendLocation(a(this.chatId,"sendLocation"),e,t,{business_connection_id:this.businessConnectionId,...r},n)}editMessageLiveLocation(e,t,r,n){const i=this.inlineMessageId;return i!==void 0?this.api.editMessageLiveLocationInline(i,e,t,r):this.api.editMessageLiveLocation(a(this.chatId,"editMessageLiveLocation"),a(this.msgId,"editMessageLiveLocation"),e,t,r,n)}stopMessageLiveLocation(e,t){const r=this.inlineMessageId;return r!==void 0?this.api.stopMessageLiveLocationInline(r,e):this.api.stopMessageLiveLocation(a(this.chatId,"stopMessageLiveLocation"),a(this.msgId,"stopMessageLiveLocation"),e,t)}sendPaidMedia(e,t,r,n){return this.api.sendPaidMedia(a(this.chatId,"sendPaidMedia"),e,t,r,n)}replyWithVenue(e,t,r,n,i,o){return this.api.sendVenue(a(this.chatId,"sendVenue"),e,t,r,n,{business_connection_id:this.businessConnectionId,...i},o)}replyWithContact(e,t,r,n){return this.api.sendContact(a(this.chatId,"sendContact"),e,t,{business_connection_id:this.businessConnectionId,...r},n)}replyWithPoll(e,t,r,n){return this.api.sendPoll(a(this.chatId,"sendPoll"),e,t,{business_connection_id:this.businessConnectionId,...r},n)}replyWithDice(e,t,r){return this.api.sendDice(a(this.chatId,"sendDice"),e,{business_connection_id:this.businessConnectionId,...t},r)}replyWithChatAction(e,t,r){return this.api.sendChatAction(a(this.chatId,"sendChatAction"),e,{business_connection_id:this.businessConnectionId,...t},r)}react(e,t,r){return this.api.setMessageReaction(a(this.chatId,"setMessageReaction"),a(this.msgId,"setMessageReaction"),typeof e=="string"?[{type:"emoji",emoji:e}]:(Array.isArray(e)?e:[e]).map(n=>typeof n=="string"?{type:"emoji",emoji:n}:n),t,r)}getUserProfilePhotos(e,t){return this.api.getUserProfilePhotos(a(this.from,"getUserProfilePhotos").id,e,t)}getUserChatBoosts(e,t){return this.api.getUserChatBoosts(e,a(this.from,"getUserChatBoosts").id,t)}getBusinessConnection(e){return this.api.getBusinessConnection(a(this.businessConnectionId,"getBusinessConnection"),e)}getFile(e){const t=a(this.msg,"getFile"),r=t.photo!==void 0?t.photo[t.photo.length-1]:t.animation??t.audio??t.document??t.video??t.video_note??t.voice??t.sticker;return this.api.getFile(a(r,"getFile").file_id,e)}kickAuthor(...e){return this.banAuthor(...e)}banAuthor(e,t){return this.api.banChatMember(a(this.chatId,"banAuthor"),a(this.from,"banAuthor").id,e,t)}kickChatMember(...e){return this.banChatMember(...e)}banChatMember(e,t,r){return this.api.banChatMember(a(this.chatId,"banChatMember"),e,t,r)}unbanChatMember(e,t,r){return this.api.unbanChatMember(a(this.chatId,"unbanChatMember"),e,t,r)}restrictAuthor(e,t,r){return this.api.restrictChatMember(a(this.chatId,"restrictAuthor"),a(this.from,"restrictAuthor").id,e,t,r)}restrictChatMember(e,t,r,n){return this.api.restrictChatMember(a(this.chatId,"restrictChatMember"),e,t,r,n)}promoteAuthor(e,t){return this.api.promoteChatMember(a(this.chatId,"promoteAuthor"),a(this.from,"promoteAuthor").id,e,t)}promoteChatMember(e,t,r){return this.api.promoteChatMember(a(this.chatId,"promoteChatMember"),e,t,r)}setChatAdministratorAuthorCustomTitle(e,t){return this.api.setChatAdministratorCustomTitle(a(this.chatId,"setChatAdministratorAuthorCustomTitle"),a(this.from,"setChatAdministratorAuthorCustomTitle").id,e,t)}setChatAdministratorCustomTitle(e,t,r){return this.api.setChatAdministratorCustomTitle(a(this.chatId,"setChatAdministratorCustomTitle"),e,t,r)}banChatSenderChat(e,t){return this.api.banChatSenderChat(a(this.chatId,"banChatSenderChat"),e,t)}unbanChatSenderChat(e,t){return this.api.unbanChatSenderChat(a(this.chatId,"unbanChatSenderChat"),e,t)}setChatPermissions(e,t,r){return this.api.setChatPermissions(a(this.chatId,"setChatPermissions"),e,t,r)}exportChatInviteLink(e){return this.api.exportChatInviteLink(a(this.chatId,"exportChatInviteLink"),e)}createChatInviteLink(e,t){return this.api.createChatInviteLink(a(this.chatId,"createChatInviteLink"),e,t)}editChatInviteLink(e,t,r){return this.api.editChatInviteLink(a(this.chatId,"editChatInviteLink"),e,t,r)}createChatSubscriptionInviteLink(e,t,r,n){return this.api.createChatSubscriptionInviteLink(a(this.chatId,"createChatSubscriptionInviteLink"),e,t,r,n)}editChatSubscriptionInviteLink(e,t,r){return this.api.editChatSubscriptionInviteLink(a(this.chatId,"editChatSubscriptionInviteLink"),e,t,r)}revokeChatInviteLink(e,t){return this.api.revokeChatInviteLink(a(this.chatId,"editChatInviteLink"),e,t)}approveChatJoinRequest(e,t){return this.api.approveChatJoinRequest(a(this.chatId,"approveChatJoinRequest"),e,t)}declineChatJoinRequest(e,t){return this.api.declineChatJoinRequest(a(this.chatId,"declineChatJoinRequest"),e,t)}setChatPhoto(e,t){return this.api.setChatPhoto(a(this.chatId,"setChatPhoto"),e,t)}deleteChatPhoto(e){return this.api.deleteChatPhoto(a(this.chatId,"deleteChatPhoto"),e)}setChatTitle(e,t){return this.api.setChatTitle(a(this.chatId,"setChatTitle"),e,t)}setChatDescription(e,t){return this.api.setChatDescription(a(this.chatId,"setChatDescription"),e,t)}pinChatMessage(e,t,r){return this.api.pinChatMessage(a(this.chatId,"pinChatMessage"),e,t,r)}unpinChatMessage(e,t){return this.api.unpinChatMessage(a(this.chatId,"unpinChatMessage"),e,t)}unpinAllChatMessages(e){return this.api.unpinAllChatMessages(a(this.chatId,"unpinAllChatMessages"),e)}leaveChat(e){return this.api.leaveChat(a(this.chatId,"leaveChat"),e)}getChat(e){return this.api.getChat(a(this.chatId,"getChat"),e)}getChatAdministrators(e){return this.api.getChatAdministrators(a(this.chatId,"getChatAdministrators"),e)}getChatMembersCount(...e){return this.getChatMemberCount(...e)}getChatMemberCount(e){return this.api.getChatMemberCount(a(this.chatId,"getChatMemberCount"),e)}getAuthor(e){return this.api.getChatMember(a(this.chatId,"getAuthor"),a(this.from,"getAuthor").id,e)}getChatMember(e,t){return this.api.getChatMember(a(this.chatId,"getChatMember"),e,t)}setChatStickerSet(e,t){return this.api.setChatStickerSet(a(this.chatId,"setChatStickerSet"),e,t)}deleteChatStickerSet(e){return this.api.deleteChatStickerSet(a(this.chatId,"deleteChatStickerSet"),e)}createForumTopic(e,t,r){return this.api.createForumTopic(a(this.chatId,"createForumTopic"),e,t,r)}editForumTopic(e,t){const r=a(this.msg,"editForumTopic"),n=a(r.message_thread_id,"editForumTopic");return this.api.editForumTopic(r.chat.id,n,e,t)}closeForumTopic(e){const t=a(this.msg,"closeForumTopic"),r=a(t.message_thread_id,"closeForumTopic");return this.api.closeForumTopic(t.chat.id,r,e)}reopenForumTopic(e){const t=a(this.msg,"reopenForumTopic"),r=a(t.message_thread_id,"reopenForumTopic");return this.api.reopenForumTopic(t.chat.id,r,e)}deleteForumTopic(e){const t=a(this.msg,"deleteForumTopic"),r=a(t.message_thread_id,"deleteForumTopic");return this.api.deleteForumTopic(t.chat.id,r,e)}unpinAllForumTopicMessages(e){const t=a(this.msg,"unpinAllForumTopicMessages"),r=a(t.message_thread_id,"unpinAllForumTopicMessages");return this.api.unpinAllForumTopicMessages(t.chat.id,r,e)}editGeneralForumTopic(e,t){return this.api.editGeneralForumTopic(a(this.chatId,"editGeneralForumTopic"),e,t)}closeGeneralForumTopic(e){return this.api.closeGeneralForumTopic(a(this.chatId,"closeGeneralForumTopic"),e)}reopenGeneralForumTopic(e){return this.api.reopenGeneralForumTopic(a(this.chatId,"reopenGeneralForumTopic"),e)}hideGeneralForumTopic(e){return this.api.hideGeneralForumTopic(a(this.chatId,"hideGeneralForumTopic"),e)}unhideGeneralForumTopic(e){return this.api.unhideGeneralForumTopic(a(this.chatId,"unhideGeneralForumTopic"),e)}unpinAllGeneralForumTopicMessages(e){return this.api.unpinAllGeneralForumTopicMessages(a(this.chatId,"unpinAllGeneralForumTopicMessages"),e)}answerCallbackQuery(e,t){return this.api.answerCallbackQuery(a(this.callbackQuery,"answerCallbackQuery").id,typeof e=="string"?{text:e}:e,t)}setChatMenuButton(e,t){return this.api.setChatMenuButton(e,t)}getChatMenuButton(e,t){return this.api.getChatMenuButton(e,t)}setMyDefaultAdministratorRights(e,t){return this.api.setMyDefaultAdministratorRights(e,t)}getMyDefaultAdministratorRights(e,t){return this.api.getMyDefaultAdministratorRights(e,t)}editMessageText(e,t,r){var i,o,c;const n=this.inlineMessageId;return n!==void 0?this.api.editMessageTextInline(n,e,t):this.api.editMessageText(a(this.chatId,"editMessageText"),a(((i=this.msg)==null?void 0:i.message_id)??((o=this.messageReaction)==null?void 0:o.message_id)??((c=this.messageReactionCount)==null?void 0:c.message_id),"editMessageText"),e,t,r)}editMessageCaption(e,t){var n,i,o;const r=this.inlineMessageId;return r!==void 0?this.api.editMessageCaptionInline(r,e):this.api.editMessageCaption(a(this.chatId,"editMessageCaption"),a(((n=this.msg)==null?void 0:n.message_id)??((i=this.messageReaction)==null?void 0:i.message_id)??((o=this.messageReactionCount)==null?void 0:o.message_id),"editMessageCaption"),e,t)}editMessageMedia(e,t,r){var i,o,c;const n=this.inlineMessageId;return n!==void 0?this.api.editMessageMediaInline(n,e,t):this.api.editMessageMedia(a(this.chatId,"editMessageMedia"),a(((i=this.msg)==null?void 0:i.message_id)??((o=this.messageReaction)==null?void 0:o.message_id)??((c=this.messageReactionCount)==null?void 0:c.message_id),"editMessageMedia"),e,t,r)}editMessageReplyMarkup(e,t){var n,i,o;const r=this.inlineMessageId;return r!==void 0?this.api.editMessageReplyMarkupInline(r,e):this.api.editMessageReplyMarkup(a(this.chatId,"editMessageReplyMarkup"),a(((n=this.msg)==null?void 0:n.message_id)??((i=this.messageReaction)==null?void 0:i.message_id)??((o=this.messageReactionCount)==null?void 0:o.message_id),"editMessageReplyMarkup"),e,t)}stopPoll(e,t){var r,n,i;return this.api.stopPoll(a(this.chatId,"stopPoll"),a(((r=this.msg)==null?void 0:r.message_id)??((n=this.messageReaction)==null?void 0:n.message_id)??((i=this.messageReactionCount)==null?void 0:i.message_id),"stopPoll"),e,t)}deleteMessage(e){var t,r,n;return this.api.deleteMessage(a(this.chatId,"deleteMessage"),a(((t=this.msg)==null?void 0:t.message_id)??((r=this.messageReaction)==null?void 0:r.message_id)??((n=this.messageReactionCount)==null?void 0:n.message_id),"deleteMessage"),e)}deleteMessages(e,t){return this.api.deleteMessages(a(this.chatId,"deleteMessages"),e,t)}replyWithSticker(e,t,r){return this.api.sendSticker(a(this.chatId,"sendSticker"),e,{business_connection_id:this.businessConnectionId,...t},r)}getCustomEmojiStickers(e){var t;return this.api.getCustomEmojiStickers((((t=this.msg)==null?void 0:t.entities)??[]).filter(r=>r.type==="custom_emoji").map(r=>r.custom_emoji_id),e)}answerInlineQuery(e,t,r){return this.api.answerInlineQuery(a(this.inlineQuery,"answerInlineQuery").id,e,t,r)}replyWithInvoice(e,t,r,n,i,o,c){return this.api.sendInvoice(a(this.chatId,"sendInvoice"),e,t,r,n,i,o,c)}answerShippingQuery(e,t,r){return this.api.answerShippingQuery(a(this.shippingQuery,"answerShippingQuery").id,e,t,r)}answerPreCheckoutQuery(e,t,r){return this.api.answerPreCheckoutQuery(a(this.preCheckoutQuery,"answerPreCheckoutQuery").id,e,typeof t=="string"?{error_message:t}:t,r)}refundStarPayment(e){var t;return this.api.refundStarPayment(a(this.from,"refundStarPayment").id,a((t=this.msg)==null?void 0:t.successful_payment,"refundStarPayment").telegram_payment_charge_id,e)}setPassportDataErrors(e,t){return this.api.setPassportDataErrors(a(this.from,"setPassportDataErrors").id,e,t)}replyWithGame(e,t,r){return this.api.sendGame(a(this.chatId,"sendGame"),e,{business_connection_id:this.businessConnectionId,...t},r)}};p(k,"has",S);let T=k;function a(s,e){if(s===void 0)throw new Error(`Missing information for API call to ${e}`);return s}function P(s){return ie(s).map(e=>typeof e=="string"?t=>t===e?e:null:t=>t.match(e))}function N(s,e,t){for(const r of t){const n=r(e);if(n)return s.match=n,!0}return!1}function ie(s){return Array.isArray(s)?s:[s]}class ge extends Error{constructor(t,r){super(xt(t));p(this,"error");p(this,"ctx");this.error=t,this.ctx=r,this.name="BotError",t instanceof Error&&(this.stack=t.stack)}}function xt(s){let e;if(s instanceof Error)e=`${s.name} in middleware: ${s.message}`;else{const t=typeof s;switch(e=`Non-error value of type ${t} thrown in middleware`,t){case"bigint":case"boolean":case"number":case"symbol":e+=`: ${s}`;break;case"string":e+=`: ${String(s).substring(0,50)}`;break;default:e+="!";break}}return e}function K(s){return typeof s=="function"?s:(e,t)=>s.middleware()(e,t)}function Oe(s,e){return async(t,r)=>{let n=!1;await s(t,async()=>{if(n)throw new Error("`next` already called before!");n=!0,await e(t,r)})}}function de(s,e){return e()}const Ot=()=>Promise.resolve();async function Ye(s,e){await s(e,Ot)}class x{constructor(...e){p(this,"handler");this.handler=e.length===0?de:e.map(K).reduce(Oe)}middleware(){return this.handler}use(...e){const t=new x(...e);return this.handler=Oe(this.handler,K(t)),t}on(e,...t){return this.filter(T.has.filterQuery(e),...t)}hears(e,...t){return this.filter(T.has.text(e),...t)}command(e,...t){return this.filter(T.has.command(e),...t)}reaction(e,...t){return this.filter(T.has.reaction(e),...t)}chatType(e,...t){return this.filter(T.has.chatType(e),...t)}callbackQuery(e,...t){return this.filter(T.has.callbackQuery(e),...t)}gameQuery(e,...t){return this.filter(T.has.gameQuery(e),...t)}inlineQuery(e,...t){return this.filter(T.has.inlineQuery(e),...t)}chosenInlineResult(e,...t){return this.filter(T.has.chosenInlineResult(e),...t)}preCheckoutQuery(e,...t){return this.filter(T.has.preCheckoutQuery(e),...t)}shippingQuery(e,...t){return this.filter(T.has.shippingQuery(e),...t)}filter(e,...t){const r=new x(...t);return this.branch(e,r,de),r}drop(e,...t){return this.filter(async r=>!await e(r),...t)}fork(...e){const t=new x(...e),r=K(t);return this.use((n,i)=>Promise.all([i(),Ye(r,n)])),t}lazy(e){return this.use(async(t,r)=>{const n=await e(t),i=Array.isArray(n)?n:[n];await K(new x(...i))(t,r)})}route(e,t,r=de){return this.lazy(async n=>{const i=await e(n);return(i===void 0||!t[i]?r:t[i])??[]})}branch(e,t,r){return this.lazy(async n=>await e(n)?t:r)}errorBoundary(e,...t){const r=new x(...t),n=K(r);return this.use(async(i,o)=>{let c=!1;const u=()=>(c=!0,Promise.resolve());try{await n(i,u)}catch(l){c=!1,await e(new ge(l,i),u)}c&&await o()}),r}}var V=1e3,W=V*60,J=W*60,L=J*24,Lt=L*7,Dt=L*365.25,jt=function(s,e){e=e||{};var t=typeof s;if(t==="string"&&s.length>0)return $t(s);if(t==="number"&&isFinite(s))return e.long?Ut(s):Qt(s);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(s))};function $t(s){if(s=String(s),!(s.length>100)){var e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(s);if(e){var t=parseFloat(e[1]),r=(e[2]||"ms").toLowerCase();switch(r){case"years":case"year":case"yrs":case"yr":case"y":return t*Dt;case"weeks":case"week":case"w":return t*Lt;case"days":case"day":case"d":return t*L;case"hours":case"hour":case"hrs":case"hr":case"h":return t*J;case"minutes":case"minute":case"mins":case"min":case"m":return t*W;case"seconds":case"second":case"secs":case"sec":case"s":return t*V;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return t;default:return}}}}function Qt(s){var e=Math.abs(s);return e>=L?Math.round(s/L)+"d":e>=J?Math.round(s/J)+"h":e>=W?Math.round(s/W)+"m":e>=V?Math.round(s/V)+"s":s+"ms"}function Ut(s){var e=Math.abs(s);return e>=L?te(s,e,L,"day"):e>=J?te(s,e,J,"hour"):e>=W?te(s,e,W,"minute"):e>=V?te(s,e,V,"second"):s+" ms"}function te(s,e,t,r){var n=e>=t*1.5;return Math.round(s/t)+" "+r+(n?"s":"")}function He(){throw new Error("setTimeout has not been defined")}function Ke(){throw new Error("clearTimeout has not been defined")}var F=He,R=Ke,q;typeof window<"u"?q=window:typeof self<"u"?q=self:q={};typeof q.setTimeout=="function"&&(F=setTimeout);typeof q.clearTimeout=="function"&&(R=clearTimeout);function ze(s){if(F===setTimeout)return setTimeout(s,0);if((F===He||!F)&&setTimeout)return F=setTimeout,setTimeout(s,0);try{return F(s,0)}catch{try{return F.call(null,s,0)}catch{return F.call(this,s,0)}}}function qt(s){if(R===clearTimeout)return clearTimeout(s);if((R===Ke||!R)&&clearTimeout)return R=clearTimeout,clearTimeout(s);try{return R(s)}catch{try{return R.call(null,s)}catch{return R.call(this,s)}}}var E=[],G=!1,O,ne=-1;function Gt(){!G||!O||(G=!1,O.length?E=O.concat(E):ne=-1,E.length&&Xe())}function Xe(){if(!G){var s=ze(Gt);G=!0;for(var e=E.length;e;){for(O=E,E=[];++ne<e;)O&&O[ne].run();ne=-1,e=E.length}O=null,G=!1,qt(s)}}function Bt(s){var e=new Array(arguments.length-1);if(arguments.length>1)for(var t=1;t<arguments.length;t++)e[t-1]=arguments[t];E.push(new Ze(s,e)),E.length===1&&!G&&ze(Xe)}function Ze(s,e){this.fun=s,this.array=e}Ze.prototype.run=function(){this.fun.apply(null,this.array)};var Vt="browser",Wt="browser",Jt=!0,Yt=[],Ht="",Kt={},zt={},Xt={};function D(){}var Zt=D,er=D,tr=D,rr=D,sr=D,nr=D,ir=D;function or(s){throw new Error("process.binding is not supported")}function ar(){return"/"}function cr(s){throw new Error("process.chdir is not supported")}function ur(){return 0}var Q=q.performance||{},hr=Q.now||Q.mozNow||Q.msNow||Q.oNow||Q.webkitNow||function(){return new Date().getTime()};function lr(s){var e=hr.call(Q)*.001,t=Math.floor(e),r=Math.floor(e%1*1e9);return s&&(t=t-s[0],r=r-s[1],r<0&&(t--,r+=1e9)),[t,r]}var dr=new Date;function pr(){var s=new Date,e=s-dr;return e/1e3}var pe={nextTick:Bt,title:Vt,browser:Jt,env:{NODE_ENV:"production"},argv:Yt,version:Ht,versions:Kt,on:Zt,addListener:er,once:tr,off:rr,removeListener:sr,removeAllListeners:nr,emit:ir,binding:or,cwd:ar,chdir:cr,umask:ur,hrtime:lr,platform:Wt,release:zt,config:Xt,uptime:pr};function mr(s,e,t){return t={path:e,exports:{},require:function(r,n){return fr(r,n??t.path)}},s(t,t.exports),t.exports}function fr(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}function gr(s){t.debug=t,t.default=t,t.coerce=u,t.disable=i,t.enable=n,t.enabled=o,t.humanize=jt,t.destroy=l,Object.keys(s).forEach(h=>{t[h]=s[h]}),t.names=[],t.skips=[],t.formatters={};function e(h){let d=0;for(let m=0;m<h.length;m++)d=(d<<5)-d+h.charCodeAt(m),d|=0;return t.colors[Math.abs(d)%t.colors.length]}t.selectColor=e;function t(h){let d,m=null,b,f;function g(...y){if(!g.enabled)return;const C=g,j=Number(new Date),Te=j-(d||j);C.diff=Te,C.prev=d,C.curr=j,d=j,y[0]=t.coerce(y[0]),typeof y[0]!="string"&&y.unshift("%O");let $=0;y[0]=y[0].replace(/%([a-zA-Z%])/g,(ue,ft)=>{if(ue==="%%")return"%";$++;const Me=t.formatters[ft];if(typeof Me=="function"){const gt=y[$];ue=Me.call(C,gt),y.splice($,1),$--}return ue}),t.formatArgs.call(C,y),(C.log||t.log).apply(C,y)}return g.namespace=h,g.useColors=t.useColors(),g.color=t.selectColor(h),g.extend=r,g.destroy=t.destroy,Object.defineProperty(g,"enabled",{enumerable:!0,configurable:!1,get:()=>m!==null?m:(b!==t.namespaces&&(b=t.namespaces,f=t.enabled(h)),f),set:y=>{m=y}}),typeof t.init=="function"&&t.init(g),g}function r(h,d){const m=t(this.namespace+(typeof d>"u"?":":d)+h);return m.log=this.log,m}function n(h){t.save(h),t.namespaces=h,t.names=[],t.skips=[];let d;const m=(typeof h=="string"?h:"").split(/[\s,]+/),b=m.length;for(d=0;d<b;d++)m[d]&&(h=m[d].replace(/\*/g,".*?"),h[0]==="-"?t.skips.push(new RegExp("^"+h.slice(1)+"$")):t.names.push(new RegExp("^"+h+"$")))}function i(){const h=[...t.names.map(c),...t.skips.map(c).map(d=>"-"+d)].join(",");return t.enable(""),h}function o(h){if(h[h.length-1]==="*")return!0;let d,m;for(d=0,m=t.skips.length;d<m;d++)if(t.skips[d].test(h))return!1;for(d=0,m=t.names.length;d<m;d++)if(t.names[d].test(h))return!0;return!1}function c(h){return h.toString().substring(2,h.toString().length-2).replace(/\.\*\?$/,"*")}function u(h){return h instanceof Error?h.stack||h.message:h}function l(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return t.enable(t.load()),t}var yr=gr,v=mr(function(s,e){e.formatArgs=r,e.save=n,e.load=i,e.useColors=t,e.storage=o(),e.destroy=(()=>{let u=!1;return()=>{u||(u=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function t(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function r(u){if(u[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+u[0]+(this.useColors?"%c ":" ")+"+"+s.exports.humanize(this.diff),!this.useColors)return;const l="color: "+this.color;u.splice(1,0,l,"color: inherit");let h=0,d=0;u[0].replace(/%[a-zA-Z%]/g,m=>{m!=="%%"&&(h++,m==="%c"&&(d=h))}),u.splice(d,0,l)}e.log=console.debug||console.log||(()=>{});function n(u){try{u?e.storage.setItem("debug",u):e.storage.removeItem("debug")}catch{}}function i(){let u;try{u=e.storage.getItem("debug")}catch{}return!u&&typeof pe<"u"&&"env"in pe&&(u=pe.env.DEBUG),u}function o(){try{return localStorage}catch{}}s.exports=yr(e);const{formatters:c}=s.exports;c.j=function(u){try{return JSON.stringify(u)}catch(l){return"[UnexpectedJSONParseError]: "+l.message}}});v.colors;v.destroy;v.formatArgs;v.load;v.log;v.save;v.storage;v.useColors;const Cr=s=>{const e=s[Symbol.asyncIterator]();return new ReadableStream({async pull(t){const r=await e.next();r.done?t.close():t.enqueue(r.value)}})},wr=s=>({}),Le=v("grammy:warn");class ce extends Error{constructor(t,r,n,i){super(`${t} (${r.error_code}: ${r.description})`);p(this,"method");p(this,"payload");p(this,"ok");p(this,"error_code");p(this,"description");p(this,"parameters");this.method=n,this.payload=i,this.ok=!1,this.name="GrammyError",this.error_code=r.error_code,this.description=r.description,this.parameters=r.parameters??{}}}function _r(s,e,t){switch(s.error_code){case 401:Le("Error 401 means that your bot token is wrong, talk to https://t.me/BotFather to check it.");break;case 409:Le("Error 409 means that you are running your bot several times on long polling. Consider revoking the bot token if you believe that no other instance is running.");break}return new ce(`Call to '${e}' failed!`,s,e,t)}class ve extends Error{constructor(t,r){super(t);p(this,"error");this.error=r,this.name="HttpError"}}function br(s){return typeof s=="object"&&s!==null&&"status"in s&&"statusText"in s}function vr(s,e){return t=>{let r=`Network request for '${s}' failed!`;throw br(t)&&(r+=` (${t.status}: ${t.statusText})`),e&&t instanceof Error&&(r+=` ${t.message}`),new ve(r,t)}}const Ir=(()=>{var t,r,n;const{Deno:s}=globalThis;if(typeof((t=s==null?void 0:s.build)==null?void 0:t.os)=="string")return s.build.os;const{navigator:e}=globalThis;return(n=(r=e==null?void 0:e.appVersion)==null?void 0:r.includes)!=null&&n.call(r,"Win")?"windows":"linux"})(),kr=Ir==="windows";function Tr(s){if(typeof s!="string")throw new TypeError(`Path must be a string. Received ${JSON.stringify(s)}`)}function et(s,e){if(e.length>=s.length)return s;const t=s.length-e.length;for(let r=e.length-1;r>=0;--r)if(s.charCodeAt(t+r)!==e.charCodeAt(r))return s;return s.slice(0,-e.length)}function tt(s,e,t=0){let r=!1,n=s.length;for(let i=s.length-1;i>=t;--i)if(e(s.charCodeAt(i))){if(r){t=i+1;break}}else r||(r=!0,n=i+1);return s.slice(t,n)}function rt(s,e){if(Tr(s),s.length===0)return s;if(typeof e!="string")throw new TypeError(`Suffix must be a string. Received ${JSON.stringify(e)}`)}function st(s,e){if(s.length<=1)return s;let t=s.length;for(let r=s.length-1;r>0&&e(s.charCodeAt(r));r--)t=r;return s.slice(0,t)}function De(s){return s===47}function Mr(s,e=""){rt(s,e);const t=tt(s,De),r=st(t,De);return e?et(r,e):r}function je(s){return s===47||s===92}function Sr(s){return s>=97&&s<=122||s>=65&&s<=90}function Er(s,e=""){rt(s,e);let t=0;if(s.length>=2){const i=s.charCodeAt(0);Sr(i)&&s.charCodeAt(1)===58&&(t=2)}const r=tt(s,je,t),n=st(r,je);return e?et(n,e):n}function re(s,e=""){return kr?Er(s,e):Mr(s,e)}class ye{constructor(e,t){p(this,"consumed",!1);p(this,"fileData");p(this,"filename");this.fileData=e,t??(t=this.guessFilename(e)),this.filename=t}guessFilename(e){if(typeof e=="string")return re(e);if(typeof e=="object"){if("url"in e)return re(e.url);if(e instanceof URL)return re(e.pathname)||re(e.hostname)}}toRaw(){if(this.consumed)throw new Error("Cannot reuse InputFile data source!");const e=this.fileData;return e instanceof Blob?e.stream():e instanceof URL?$e(e):"url"in e?$e(e.url):(e instanceof Uint8Array||(this.consumed=!0),e)}}async function*$e(s){const{body:e}=await fetch(s);if(e===null)throw new Error(`Download failed, no response body from '${s}'`);yield*e}function Ce(s){return s instanceof ye||typeof s=="object"&&s!==null&&Object.values(s).some(e=>Array.isArray(e)?e.some(Ce):e instanceof ye||Ce(e))}function nt(s){return JSON.stringify(s,(e,t)=>t??void 0)}function Qe(s){return{method:"POST",headers:{"content-type":"application/json",connection:"keep-alive"},body:nt(s)}}async function*Ar(s,e){try{yield*s}catch(t){e(t)}}function Fr(s,e){const t=Rr(),r=Pr(s,t),n=Ar(r,e),i=Cr(n);return{method:"POST",headers:{"content-type":`multipart/form-data; boundary=${t}`,connection:"keep-alive"},body:i}}function Rr(){return"----------"+it(32)}function it(s=16){return Array.from(Array(s)).map(()=>Math.random().toString(36)[2]||0).join("")}const X=new TextEncoder;async function*Pr(s,e){const t=we(s);yield X.encode(`--${e}\r
`);const r=X.encode(`\r
--${e}\r
`);let n=!0;for(const[i,o]of Object.entries(s))o!=null&&(n||(yield r),yield Nr(i,typeof o=="object"?nt(o):o),n=!1);for(const{id:i,origin:o,file:c}of t)n||(yield r),yield*xr(i,o,c),n=!1;yield X.encode(`\r
--${e}--\r
`)}function we(s){return typeof s!="object"||s===null?[]:Object.entries(s).flatMap(([e,t])=>{if(Array.isArray(t))return t.flatMap(r=>we(r));if(t instanceof ye){const r=it();Object.assign(s,{[e]:`attach://${r}`});const n=e==="media"&&"type"in s&&typeof s.type=="string"?s.type:e;return{id:r,origin:n,file:t}}else return we(t)})}function Nr(s,e){return X.encode(`content-disposition:form-data;name="${s}"\r
\r
${e}`)}async function*xr(s,e,t){const r=t.filename||`${e}.${Or(e)}`;if(r.includes("\r")||r.includes(`
`))throw new Error(`File paths cannot contain carriage-return (\\r) or newline (\\n) characters! Filename for property '${e}' was:
"""
${r}
"""`);yield X.encode(`content-disposition:form-data;name="${s}";filename=${r}\r
content-type:application/octet-stream\r
\r
`);const n=await t.toRaw();n instanceof Uint8Array?yield n:yield*n}function Or(s){switch(s){case"certificate":return"pem";case"photo":case"thumbnail":return"jpg";case"voice":return"ogg";case"audio":return"mp3";case"animation":case"video":case"video_note":return"mp4";case"sticker":return"webp";default:return"dat"}}const Lr=v("grammy:core");function Dr(s,e){return(t,r,n)=>e(s,t,r,n)}class jr{constructor(e,t={},r={}){p(this,"token");p(this,"webhookReplyEnvelope");p(this,"options");p(this,"hasUsedWebhookReply");p(this,"installedTransformers");p(this,"call");this.token=e,this.webhookReplyEnvelope=r,this.hasUsedWebhookReply=!1,this.installedTransformers=[],this.call=async(o,c,u)=>{const l=c??{};Lr(`Calling ${o}`),u!==void 0&&Vr(o,l,u);const h=this.options,d=Ce(l);if(this.webhookReplyEnvelope.send!==void 0&&!this.hasUsedWebhookReply&&!d&&h.canUseWebhookReply(o)){this.hasUsedWebhookReply=!0;const H=Qe({...l,method:o});return await this.webhookReplyEnvelope.send(H.body),{ok:!0,result:!0}}const m=Br(u),b=qr(m,h.timeoutSeconds,o),f=Gr(m),g=h.buildUrl(h.apiRoot,this.token,o,h.environment),y=d?Fr(l,H=>f.catch(H)):Qe(l),C=m.signal,j={...h.baseFetchConfig,signal:C,...y},$=[fetch(g instanceof URL?g.href:g,j).catch(vr(o,h.sensitiveLogs)),f.promise,b.promise];try{return await(await Promise.race($)).json()}finally{b.handle!==void 0&&clearTimeout(b.handle)}};const n=t.apiRoot??"https://api.telegram.org",i=t.environment??"prod";if(this.options={apiRoot:n,environment:i,buildUrl:t.buildUrl??Qr,timeoutSeconds:t.timeoutSeconds??500,baseFetchConfig:{...wr(),...t.baseFetchConfig},canUseWebhookReply:t.canUseWebhookReply??(()=>!1),sensitiveLogs:t.sensitiveLogs??!1},this.options.apiRoot.endsWith("/"))throw new Error(`Remove the trailing '/' from the 'apiRoot' option (use '${this.options.apiRoot.substring(0,this.options.apiRoot.length-1)}' instead of '${this.options.apiRoot}')`)}use(...e){return this.call=e.reduce(Dr,this.call),this.installedTransformers.push(...e),this}async callApi(e,t,r){const n=await this.call(e,t,r);if(n.ok)return n.result;throw _r(n,e,t)}}function $r(s,e,t){const r=new jr(s,e,t),n={get(u,l){return l==="toJSON"?"__internal":r.callApi.bind(r,l)},...Ur},i=new Proxy({},n),o=r.installedTransformers,c={raw:i,installedTransformers:o,use:(...u)=>(r.use(...u),c)};return c}const Qr=(s,e,t,r)=>`${s}/bot${e}/${r==="test"?"test/":""}${t}`,Ur={set(){return!1},defineProperty(){return!1},deleteProperty(){return!1},ownKeys(){return[]}};function qr(s,e,t){let r;return{promise:new Promise((i,o)=>{r=setTimeout(()=>{const c=`Request to '${t}' timed out after ${e} seconds`;o(new Error(c)),s.abort()},1e3*e)}),handle:r}}function Gr(s){let e=r=>{throw r};return{promise:new Promise((r,n)=>{e=i=>{n(i),s.abort()}}),catch:e}}function Br(s){const e=new AbortController;if(s===void 0)return e;const t=s;function r(){e.abort(),t.removeEventListener("abort",r)}return t.aborted?r():t.addEventListener("abort",r),{abort:r,signal:e.signal}}function Vr(s,e,t){if(typeof(t==null?void 0:t.addEventListener)=="function")return;let r=JSON.stringify(e);r.length>20&&(r=r.substring(0,16)+" ...");let n=JSON.stringify(t);throw n.length>20&&(n=n.substring(0,16)+" ..."),new Error(`Incorrect abort signal instance found! You passed two payloads to '${s}' but you should merge the second one containing '${n}' into the first one containing '${r}'! If you are using context shortcuts, you may want to use a method on 'ctx.api' instead.

If you want to prevent such mistakes in the future, consider using TypeScript. https://www.typescriptlang.org/`)}class Ue{constructor(e,t,r){p(this,"token");p(this,"options");p(this,"raw");p(this,"config");this.token=e,this.options=t;const{raw:n,use:i,installedTransformers:o}=$r(e,t,r);this.raw=n,this.config={use:i,installedTransformers:()=>o.slice()}}getUpdates(e,t){return this.raw.getUpdates({...e},t)}setWebhook(e,t,r){return this.raw.setWebhook({url:e,...t},r)}deleteWebhook(e,t){return this.raw.deleteWebhook({...e},t)}getWebhookInfo(e){return this.raw.getWebhookInfo(e)}getMe(e){return this.raw.getMe(e)}logOut(e){return this.raw.logOut(e)}close(e){return this.raw.close(e)}sendMessage(e,t,r,n){return this.raw.sendMessage({chat_id:e,text:t,...r},n)}forwardMessage(e,t,r,n,i){return this.raw.forwardMessage({chat_id:e,from_chat_id:t,message_id:r,...n},i)}forwardMessages(e,t,r,n,i){return this.raw.forwardMessages({chat_id:e,from_chat_id:t,message_ids:r,...n},i)}copyMessage(e,t,r,n,i){return this.raw.copyMessage({chat_id:e,from_chat_id:t,message_id:r,...n},i)}copyMessages(e,t,r,n,i){return this.raw.copyMessages({chat_id:e,from_chat_id:t,message_ids:r,...n},i)}sendPhoto(e,t,r,n){return this.raw.sendPhoto({chat_id:e,photo:t,...r},n)}sendAudio(e,t,r,n){return this.raw.sendAudio({chat_id:e,audio:t,...r},n)}sendDocument(e,t,r,n){return this.raw.sendDocument({chat_id:e,document:t,...r},n)}sendVideo(e,t,r,n){return this.raw.sendVideo({chat_id:e,video:t,...r},n)}sendAnimation(e,t,r,n){return this.raw.sendAnimation({chat_id:e,animation:t,...r},n)}sendVoice(e,t,r,n){return this.raw.sendVoice({chat_id:e,voice:t,...r},n)}sendVideoNote(e,t,r,n){return this.raw.sendVideoNote({chat_id:e,video_note:t,...r},n)}sendMediaGroup(e,t,r,n){return this.raw.sendMediaGroup({chat_id:e,media:t,...r},n)}sendLocation(e,t,r,n,i){return this.raw.sendLocation({chat_id:e,latitude:t,longitude:r,...n},i)}editMessageLiveLocation(e,t,r,n,i,o){return this.raw.editMessageLiveLocation({chat_id:e,message_id:t,latitude:r,longitude:n,...i},o)}editMessageLiveLocationInline(e,t,r,n,i){return this.raw.editMessageLiveLocation({inline_message_id:e,latitude:t,longitude:r,...n},i)}stopMessageLiveLocation(e,t,r,n){return this.raw.stopMessageLiveLocation({chat_id:e,message_id:t,...r},n)}stopMessageLiveLocationInline(e,t,r){return this.raw.stopMessageLiveLocation({inline_message_id:e,...t},r)}sendPaidMedia(e,t,r,n,i){return this.raw.sendPaidMedia({chat_id:e,star_count:t,media:r,...n},i)}sendVenue(e,t,r,n,i,o,c){return this.raw.sendVenue({chat_id:e,latitude:t,longitude:r,title:n,address:i,...o},c)}sendContact(e,t,r,n,i){return this.raw.sendContact({chat_id:e,phone_number:t,first_name:r,...n},i)}sendPoll(e,t,r,n,i){return this.raw.sendPoll({chat_id:e,question:t,options:r,...n},i)}sendDice(e,t,r,n){return this.raw.sendDice({chat_id:e,emoji:t,...r},n)}setMessageReaction(e,t,r,n,i){return this.raw.setMessageReaction({chat_id:e,message_id:t,reaction:r,...n},i)}sendChatAction(e,t,r,n){return this.raw.sendChatAction({chat_id:e,action:t,...r},n)}getUserProfilePhotos(e,t,r){return this.raw.getUserProfilePhotos({user_id:e,...t},r)}getUserChatBoosts(e,t,r){return this.raw.getUserChatBoosts({chat_id:e,user_id:t},r)}getBusinessConnection(e,t){return this.raw.getBusinessConnection({business_connection_id:e},t)}getFile(e,t){return this.raw.getFile({file_id:e},t)}kickChatMember(...e){return this.banChatMember(...e)}banChatMember(e,t,r,n){return this.raw.banChatMember({chat_id:e,user_id:t,...r},n)}unbanChatMember(e,t,r,n){return this.raw.unbanChatMember({chat_id:e,user_id:t,...r},n)}restrictChatMember(e,t,r,n,i){return this.raw.restrictChatMember({chat_id:e,user_id:t,permissions:r,...n},i)}promoteChatMember(e,t,r,n){return this.raw.promoteChatMember({chat_id:e,user_id:t,...r},n)}setChatAdministratorCustomTitle(e,t,r,n){return this.raw.setChatAdministratorCustomTitle({chat_id:e,user_id:t,custom_title:r},n)}banChatSenderChat(e,t,r){return this.raw.banChatSenderChat({chat_id:e,sender_chat_id:t},r)}unbanChatSenderChat(e,t,r){return this.raw.unbanChatSenderChat({chat_id:e,sender_chat_id:t},r)}setChatPermissions(e,t,r,n){return this.raw.setChatPermissions({chat_id:e,permissions:t,...r},n)}exportChatInviteLink(e,t){return this.raw.exportChatInviteLink({chat_id:e},t)}createChatInviteLink(e,t,r){return this.raw.createChatInviteLink({chat_id:e,...t},r)}editChatInviteLink(e,t,r,n){return this.raw.editChatInviteLink({chat_id:e,invite_link:t,...r},n)}createChatSubscriptionInviteLink(e,t,r,n,i){return this.raw.createChatSubscriptionInviteLink({chat_id:e,subscription_period:t,subscription_price:r,...n},i)}editChatSubscriptionInviteLink(e,t,r,n){return this.raw.editChatSubscriptionInviteLink({chat_id:e,invite_link:t,...r},n)}revokeChatInviteLink(e,t,r){return this.raw.revokeChatInviteLink({chat_id:e,invite_link:t},r)}approveChatJoinRequest(e,t,r){return this.raw.approveChatJoinRequest({chat_id:e,user_id:t},r)}declineChatJoinRequest(e,t,r){return this.raw.declineChatJoinRequest({chat_id:e,user_id:t},r)}setChatPhoto(e,t,r){return this.raw.setChatPhoto({chat_id:e,photo:t},r)}deleteChatPhoto(e,t){return this.raw.deleteChatPhoto({chat_id:e},t)}setChatTitle(e,t,r){return this.raw.setChatTitle({chat_id:e,title:t},r)}setChatDescription(e,t,r){return this.raw.setChatDescription({chat_id:e,description:t},r)}pinChatMessage(e,t,r,n){return this.raw.pinChatMessage({chat_id:e,message_id:t,...r},n)}unpinChatMessage(e,t,r){return this.raw.unpinChatMessage({chat_id:e,message_id:t},r)}unpinAllChatMessages(e,t){return this.raw.unpinAllChatMessages({chat_id:e},t)}leaveChat(e,t){return this.raw.leaveChat({chat_id:e},t)}getChat(e,t){return this.raw.getChat({chat_id:e},t)}getChatAdministrators(e,t){return this.raw.getChatAdministrators({chat_id:e},t)}getChatMembersCount(...e){return this.getChatMemberCount(...e)}getChatMemberCount(e,t){return this.raw.getChatMemberCount({chat_id:e},t)}getChatMember(e,t,r){return this.raw.getChatMember({chat_id:e,user_id:t},r)}setChatStickerSet(e,t,r){return this.raw.setChatStickerSet({chat_id:e,sticker_set_name:t},r)}deleteChatStickerSet(e,t){return this.raw.deleteChatStickerSet({chat_id:e},t)}getForumTopicIconStickers(e){return this.raw.getForumTopicIconStickers(e)}createForumTopic(e,t,r,n){return this.raw.createForumTopic({chat_id:e,name:t,...r},n)}editForumTopic(e,t,r,n){return this.raw.editForumTopic({chat_id:e,message_thread_id:t,...r},n)}closeForumTopic(e,t,r){return this.raw.closeForumTopic({chat_id:e,message_thread_id:t},r)}reopenForumTopic(e,t,r){return this.raw.reopenForumTopic({chat_id:e,message_thread_id:t},r)}deleteForumTopic(e,t,r){return this.raw.deleteForumTopic({chat_id:e,message_thread_id:t},r)}unpinAllForumTopicMessages(e,t,r){return this.raw.unpinAllForumTopicMessages({chat_id:e,message_thread_id:t},r)}editGeneralForumTopic(e,t,r){return this.raw.editGeneralForumTopic({chat_id:e,name:t},r)}closeGeneralForumTopic(e,t){return this.raw.closeGeneralForumTopic({chat_id:e},t)}reopenGeneralForumTopic(e,t){return this.raw.reopenGeneralForumTopic({chat_id:e},t)}hideGeneralForumTopic(e,t){return this.raw.hideGeneralForumTopic({chat_id:e},t)}unhideGeneralForumTopic(e,t){return this.raw.unhideGeneralForumTopic({chat_id:e},t)}unpinAllGeneralForumTopicMessages(e,t){return this.raw.unpinAllGeneralForumTopicMessages({chat_id:e},t)}answerCallbackQuery(e,t,r){return this.raw.answerCallbackQuery({callback_query_id:e,...t},r)}setMyName(e,t,r){return this.raw.setMyName({name:e,...t},r)}getMyName(e,t){return this.raw.getMyName(e??{},t)}setMyCommands(e,t,r){return this.raw.setMyCommands({commands:e,...t},r)}deleteMyCommands(e,t){return this.raw.deleteMyCommands({...e},t)}getMyCommands(e,t){return this.raw.getMyCommands({...e},t)}setMyDescription(e,t,r){return this.raw.setMyDescription({description:e,...t},r)}getMyDescription(e,t){return this.raw.getMyDescription({...e},t)}setMyShortDescription(e,t,r){return this.raw.setMyShortDescription({short_description:e,...t},r)}getMyShortDescription(e,t){return this.raw.getMyShortDescription({...e},t)}setChatMenuButton(e,t){return this.raw.setChatMenuButton({...e},t)}getChatMenuButton(e,t){return this.raw.getChatMenuButton({...e},t)}setMyDefaultAdministratorRights(e,t){return this.raw.setMyDefaultAdministratorRights({...e},t)}getMyDefaultAdministratorRights(e,t){return this.raw.getMyDefaultAdministratorRights({...e},t)}editMessageText(e,t,r,n,i){return this.raw.editMessageText({chat_id:e,message_id:t,text:r,...n},i)}editMessageTextInline(e,t,r,n){return this.raw.editMessageText({inline_message_id:e,text:t,...r},n)}editMessageCaption(e,t,r,n){return this.raw.editMessageCaption({chat_id:e,message_id:t,...r},n)}editMessageCaptionInline(e,t,r){return this.raw.editMessageCaption({inline_message_id:e,...t},r)}editMessageMedia(e,t,r,n,i){return this.raw.editMessageMedia({chat_id:e,message_id:t,media:r,...n},i)}editMessageMediaInline(e,t,r,n){return this.raw.editMessageMedia({inline_message_id:e,media:t,...r},n)}editMessageReplyMarkup(e,t,r,n){return this.raw.editMessageReplyMarkup({chat_id:e,message_id:t,...r},n)}editMessageReplyMarkupInline(e,t,r){return this.raw.editMessageReplyMarkup({inline_message_id:e,...t},r)}stopPoll(e,t,r,n){return this.raw.stopPoll({chat_id:e,message_id:t,...r},n)}deleteMessage(e,t,r){return this.raw.deleteMessage({chat_id:e,message_id:t},r)}deleteMessages(e,t,r){return this.raw.deleteMessages({chat_id:e,message_ids:t},r)}sendSticker(e,t,r,n){return this.raw.sendSticker({chat_id:e,sticker:t,...r},n)}getStickerSet(e,t){return this.raw.getStickerSet({name:e},t)}getCustomEmojiStickers(e,t){return this.raw.getCustomEmojiStickers({custom_emoji_ids:e},t)}uploadStickerFile(e,t,r,n){return this.raw.uploadStickerFile({user_id:e,sticker_format:t,sticker:r},n)}createNewStickerSet(e,t,r,n,i,o){return this.raw.createNewStickerSet({user_id:e,name:t,title:r,stickers:n,...i},o)}addStickerToSet(e,t,r,n){return this.raw.addStickerToSet({user_id:e,name:t,sticker:r},n)}setStickerPositionInSet(e,t,r){return this.raw.setStickerPositionInSet({sticker:e,position:t},r)}deleteStickerFromSet(e,t){return this.raw.deleteStickerFromSet({sticker:e},t)}replaceStickerInSet(e,t,r,n,i){return this.raw.replaceStickerInSet({user_id:e,name:t,old_sticker:r,sticker:n},i)}setStickerEmojiList(e,t,r){return this.raw.setStickerEmojiList({sticker:e,emoji_list:t},r)}setStickerKeywords(e,t,r){return this.raw.setStickerKeywords({sticker:e,keywords:t},r)}setStickerMaskPosition(e,t,r){return this.raw.setStickerMaskPosition({sticker:e,mask_position:t},r)}setStickerSetTitle(e,t,r){return this.raw.setStickerSetTitle({name:e,title:t},r)}deleteStickerSet(e,t){return this.raw.deleteStickerSet({name:e},t)}setStickerSetThumbnail(e,t,r,n,i){return this.raw.setStickerSetThumbnail({name:e,user_id:t,thumbnail:r,format:n},i)}setCustomEmojiStickerSetThumbnail(e,t,r){return this.raw.setCustomEmojiStickerSetThumbnail({name:e,custom_emoji_id:t},r)}answerInlineQuery(e,t,r,n){return this.raw.answerInlineQuery({inline_query_id:e,results:t,...r},n)}answerWebAppQuery(e,t,r){return this.raw.answerWebAppQuery({web_app_query_id:e,result:t},r)}sendInvoice(e,t,r,n,i,o,c,u){return this.raw.sendInvoice({chat_id:e,title:t,description:r,payload:n,currency:i,prices:o,...c},u)}createInvoiceLink(e,t,r,n,i,o,c,u){return this.raw.createInvoiceLink({title:e,description:t,payload:r,provider_token:n,currency:i,prices:o,...c},u)}answerShippingQuery(e,t,r,n){return this.raw.answerShippingQuery({shipping_query_id:e,ok:t,...r},n)}answerPreCheckoutQuery(e,t,r,n){return this.raw.answerPreCheckoutQuery({pre_checkout_query_id:e,ok:t,...r},n)}getStarTransactions(e,t){return this.raw.getStarTransactions({...e},t)}refundStarPayment(e,t,r){return this.raw.refundStarPayment({user_id:e,telegram_payment_charge_id:t},r)}setPassportDataErrors(e,t,r){return this.raw.setPassportDataErrors({user_id:e,errors:t},r)}sendGame(e,t,r,n){return this.raw.sendGame({chat_id:e,game_short_name:t,...r},n)}setGameScore(e,t,r,n,i,o){return this.raw.setGameScore({chat_id:e,message_id:t,user_id:r,score:n,...i},o)}setGameScoreInline(e,t,r,n,i){return this.raw.setGameScore({inline_message_id:e,user_id:t,score:r,...n},i)}getGameHighScores(e,t,r,n){return this.raw.getGameHighScores({chat_id:e,message_id:t,user_id:r},n)}getGameHighScoresInline(e,t,r){return this.raw.getGameHighScores({inline_message_id:e,user_id:t},r)}}const M=v("grammy:bot"),Wr=v("grammy:warn"),U=v("grammy:error"),ot=["message","edited_message","channel_post","edited_channel_post","business_connection","business_message","edited_business_message","deleted_business_messages","inline_query","chosen_inline_result","callback_query","shipping_query","pre_checkout_query","poll","poll_answer","my_chat_member","chat_join_request","chat_boost","removed_chat_boost"];class Jr extends x{constructor(t,r){super();p(this,"token");p(this,"pollingRunning");p(this,"pollingAbortController");p(this,"lastTriedUpdateId");p(this,"api");p(this,"me");p(this,"mePromise");p(this,"clientConfig");p(this,"ContextConstructor");p(this,"observedUpdateTypes");p(this,"errorHandler");if(this.token=t,this.pollingRunning=!1,this.lastTriedUpdateId=0,this.observedUpdateTypes=new Set,this.errorHandler=async n=>{var i,o;throw console.error("Error in middleware while handling update",(o=(i=n.ctx)==null?void 0:i.update)==null?void 0:o.update_id,n.error),console.error("No error handler was set!"),console.error("Set your own error handler with `bot.catch = ...`"),this.pollingRunning&&(console.error("Stopping bot"),await this.stop()),n},!t)throw new Error("Empty token!");this.me=r==null?void 0:r.botInfo,this.clientConfig=r==null?void 0:r.client,this.ContextConstructor=(r==null?void 0:r.ContextConstructor)??T,this.api=new Ue(t,this.clientConfig)}set botInfo(t){this.me=t}get botInfo(){if(this.me===void 0)throw new Error("Bot information unavailable! Make sure to call `await bot.init()` before accessing `bot.botInfo`!");return this.me}on(t,...r){for(const[n]of Ve(t).flatMap(We))this.observedUpdateTypes.add(n);return super.on(t,...r)}reaction(t,...r){return this.observedUpdateTypes.add("message_reaction"),super.reaction(t,...r)}isInited(){return this.me!==void 0}async init(t){if(!this.isInited()){M("Initializing bot"),this.mePromise??(this.mePromise=qe(()=>this.api.getMe(t),t));let r;try{r=await this.mePromise}finally{this.mePromise=void 0}this.me===void 0?this.me=r:M("Bot info was set by now, will not overwrite")}M(`I am ${this.me.username}!`)}async handleUpdates(t){for(const r of t){this.lastTriedUpdateId=r.update_id;try{await this.handleUpdate(r)}catch(n){if(n instanceof ge)await this.errorHandler(n);else throw console.error("FATAL: grammY unable to handle:",n),n}}}async handleUpdate(t,r){if(this.me===void 0)throw new Error("Bot not initialized! Either call `await bot.init()`, or directly set the `botInfo` option in the `Bot` constructor to specify a known bot info object.");M(`Processing update ${t.update_id}`);const n=new Ue(this.token,this.clientConfig,r),i=this.api.config.installedTransformers();i.length>0&&n.config.use(...i);const o=new this.ContextConstructor(t,n,this.me);try{await Ye(this.middleware(),o)}catch(c){throw U(`Error in middleware for update ${t.update_id}`),new ge(c,o)}}async start(t){var n,i,o;const r=[];if(this.isInited()||r.push(this.init((n=this.pollingAbortController)==null?void 0:n.signal)),this.pollingRunning){await Promise.all(r),M("Simple long polling already running!");return}this.pollingRunning=!0,this.pollingAbortController=new AbortController;try{r.push(qe(async()=>{var c;await this.api.deleteWebhook({drop_pending_updates:t==null?void 0:t.drop_pending_updates},(c=this.pollingAbortController)==null?void 0:c.signal)},(i=this.pollingAbortController)==null?void 0:i.signal)),await Promise.all(r),await((o=t==null?void 0:t.onStart)==null?void 0:o.call(t,this.botInfo))}catch(c){throw this.pollingRunning=!1,this.pollingAbortController=void 0,c}this.pollingRunning&&(Yr(this.observedUpdateTypes,t==null?void 0:t.allowed_updates),this.use=Hr,M("Starting simple long polling"),await this.loop(t),M("Middleware is done running"))}async stop(){var t;if(this.pollingRunning){M("Stopping bot, saving update offset"),this.pollingRunning=!1,(t=this.pollingAbortController)==null||t.abort();const r=this.lastTriedUpdateId+1;await this.api.getUpdates({offset:r,limit:1}).finally(()=>this.pollingAbortController=void 0)}else M("Bot is not running!")}catch(t){this.errorHandler=t}async loop(t){const r=t==null?void 0:t.limit,n=(t==null?void 0:t.timeout)??30;let i=(t==null?void 0:t.allowed_updates)??[];for(;this.pollingRunning;){const o=await this.fetchUpdates({limit:r,timeout:n,allowed_updates:i});if(o===void 0)break;await this.handleUpdates(o),i=void 0}}async fetchUpdates({limit:t,timeout:r,allowed_updates:n}){var c;const i=this.lastTriedUpdateId+1;let o;do try{o=await this.api.getUpdates({offset:i,limit:t,timeout:r,allowed_updates:n},(c=this.pollingAbortController)==null?void 0:c.signal)}catch(u){await this.handlePollingError(u)}while(o===void 0&&this.pollingRunning);return o}async handlePollingError(t){if(!this.pollingRunning){M("Pending getUpdates request cancelled");return}let r=3;if(t instanceof ce){if(U(t.message),t.error_code===401||t.error_code===409)throw t;t.error_code===429&&(U("Bot API server is closing."),r=t.parameters.retry_after??r)}else U(t);U(`Call to getUpdates failed, retrying in ${r} seconds ...`),await _e(r)}}async function qe(s,e){let r=50;async function n(o){let c=!1,u="rethrow";if(o instanceof ve)c=!0,u="retry";else if(o instanceof ce){if(o.error_code>=500)c=!0,u="retry";else if(o.error_code===429){const l=o.parameters.retry_after;typeof l=="number"?(await _e(l,e),r=50):c=!0,u="retry"}}if(c){r!==50&&await _e(r,e);const l=20*60*1e3;r=Math.min(l,2*r)}return u}let i={ok:!1};for(;!i.ok;)try{i={ok:!0,value:await s()}}catch(o){switch(U(o),await n(o)){case"retry":continue;case"rethrow":throw o}}return i.value}async function _e(s,e){let t,r;function n(){r==null||r(new Error("Aborted delay")),t!==void 0&&clearTimeout(t)}try{await new Promise((i,o)=>{if(r=o,e!=null&&e.aborted){n();return}e==null||e.addEventListener("abort",n),t=setTimeout(i,1e3*s)})}finally{e==null||e.removeEventListener("abort",n)}}function Yr(s,e=ot){const t=Array.from(s).filter(r=>!e.includes(r));t.length>0&&Wr(`You registered listeners for the following update types, but you did not specify them in \`allowed_updates\` so they may not be received: ${t.map(r=>`'${r}'`).join(", ")}`)}function Hr(){throw new Error(`It looks like you are registering more listeners on your bot from within other listeners! This means that every time your bot handles a message like this one, new listeners will be added. This list grows until your machine crashes, so grammY throws this error to tell you that you should probably do things a bit differently. If you're unsure how to resolve this problem, you can ask in the group chat: https://telegram.me/grammyjs

On the other hand, if you actually know what you're doing and you do need to install further middleware while your bot is running, consider installing a composer instance on your bot, and in turn augment the composer after the fact. This way, you can circumvent this protection against memory leaks.`)}[...ot];class I{constructor(e=[[]]){p(this,"keyboard");p(this,"is_persistent");p(this,"selective");p(this,"one_time_keyboard");p(this,"resize_keyboard");p(this,"input_field_placeholder");this.keyboard=e}add(...e){var t;return(t=this.keyboard[this.keyboard.length-1])==null||t.push(...e),this}row(...e){return this.keyboard.push(e),this}text(e){return this.add(I.text(e))}static text(e){return{text:e}}requestUsers(e,t,r={}){return this.add(I.requestUsers(e,t,r))}static requestUsers(e,t,r={}){return{text:e,request_users:{request_id:t,...r}}}requestChat(e,t,r={chat_is_channel:!1}){return this.add(I.requestChat(e,t,r))}static requestChat(e,t,r={chat_is_channel:!1}){return{text:e,request_chat:{request_id:t,...r}}}requestContact(e){return this.add(I.requestContact(e))}static requestContact(e){return{text:e,request_contact:!0}}requestLocation(e){return this.add(I.requestLocation(e))}static requestLocation(e){return{text:e,request_location:!0}}requestPoll(e,t){return this.add(I.requestPoll(e,t))}static requestPoll(e,t){return{text:e,request_poll:{type:t}}}webApp(e,t){return this.add(I.webApp(e,t))}static webApp(e,t){return{text:e,web_app:{url:t}}}persistent(e=!0){return this.is_persistent=e,this}selected(e=!0){return this.selective=e,this}oneTime(e=!0){return this.one_time_keyboard=e,this}resized(e=!0){return this.resize_keyboard=e,this}placeholder(e){return this.input_field_placeholder=e,this}toTransposed(){const e=this.keyboard,t=at(e);return this.clone(t)}toFlowed(e,t={}){const r=this.keyboard,n=ct(r,e,t);return this.clone(n)}clone(e=this.keyboard){const t=new I(e.map(r=>r.slice()));return t.is_persistent=this.is_persistent,t.selective=this.selective,t.one_time_keyboard=this.one_time_keyboard,t.resize_keyboard=this.resize_keyboard,t.input_field_placeholder=this.input_field_placeholder,t}append(...e){for(const t of e){const r=I.from(t);this.keyboard.push(...r.keyboard.map(n=>n.slice()))}return this}build(){return this.keyboard}static from(e){if(e instanceof I)return e.clone();function t(r){return typeof r=="string"?I.text(r):r}return new I(e.map(r=>r.map(t)))}}class w{constructor(e=[[]]){p(this,"inline_keyboard");this.inline_keyboard=e}add(...e){var t;return(t=this.inline_keyboard[this.inline_keyboard.length-1])==null||t.push(...e),this}row(...e){return this.inline_keyboard.push(e),this}url(e,t){return this.add(w.url(e,t))}static url(e,t){return{text:e,url:t}}text(e,t=e){return this.add(w.text(e,t))}static text(e,t=e){return{text:e,callback_data:t}}webApp(e,t){return this.add(w.webApp(e,t))}static webApp(e,t){return{text:e,web_app:{url:t}}}login(e,t){return this.add(w.login(e,t))}static login(e,t){return{text:e,login_url:typeof t=="string"?{url:t}:t}}switchInline(e,t=""){return this.add(w.switchInline(e,t))}static switchInline(e,t=""){return{text:e,switch_inline_query:t}}switchInlineCurrent(e,t=""){return this.add(w.switchInlineCurrent(e,t))}static switchInlineCurrent(e,t=""){return{text:e,switch_inline_query_current_chat:t}}switchInlineChosen(e,t={}){return this.add(w.switchInlineChosen(e,t))}static switchInlineChosen(e,t={}){return{text:e,switch_inline_query_chosen_chat:t}}game(e){return this.add(w.game(e))}static game(e){return{text:e,callback_game:{}}}pay(e){return this.add(w.pay(e))}static pay(e){return{text:e,pay:!0}}toTransposed(){const e=this.inline_keyboard,t=at(e);return new w(t)}toFlowed(e,t={}){const r=this.inline_keyboard,n=ct(r,e,t);return new w(n)}clone(){return new w(this.inline_keyboard.map(e=>e.slice()))}append(...e){for(const t of e){const r=w.from(t);this.inline_keyboard.push(...r.inline_keyboard.map(n=>n.slice()))}return this}static from(e){return e instanceof w?e.clone():new w(e.map(t=>t.slice()))}}function at(s){const e=[];for(let t=0;t<s.length;t++){const r=s[t];for(let n=0;n<r.length;n++){const i=r[n];(e[n]??(e[n]=[])).push(i)}}return e}function ct(s,e,{fillLastRow:t=!1}){let r=e;t&&(r=s.map(o=>o.length).reduce((o,c)=>o+c,0)%e);const n=[];for(const i of s)for(const o of i){const c=Math.max(0,n.length-1),u=c===0?r:e;let l=n[c]??(n[c]=[]);l.length===u&&(l=[],n.push(l)),l.push(o)}return n}v("grammy:session");v("grammy:error");function Kr(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}function zr(s){if(s.__esModule)return s;var e=s.default;if(typeof e=="function"){var t=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(s).forEach(function(r){var n=Object.getOwnPropertyDescriptor(s,r);Object.defineProperty(t,r,n.get?n:{enumerable:!0,get:function(){return s[r]}})}),t}var A={exports:{}};const Xr={},Zr=Object.freeze(Object.defineProperty({__proto__:null,default:Xr},Symbol.toStringTag,{value:"Module"})),es=zr(Zr),ts="dotenv",rs="16.4.5",ss="Loads environment variables from .env file",ns="lib/main.js",is="lib/main.d.ts",os={".":{types:"./lib/main.d.ts",require:"./lib/main.js",default:"./lib/main.js"},"./config":"./config.js","./config.js":"./config.js","./lib/env-options":"./lib/env-options.js","./lib/env-options.js":"./lib/env-options.js","./lib/cli-options":"./lib/cli-options.js","./lib/cli-options.js":"./lib/cli-options.js","./package.json":"./package.json"},as={"dts-check":"tsc --project tests/types/tsconfig.json",lint:"standard","lint-readme":"standard-markdown",pretest:"npm run lint && npm run dts-check",test:"tap tests/*.js --100 -Rspec","test:coverage":"tap --coverage-report=lcov",prerelease:"npm test",release:"standard-version"},cs={type:"git",url:"git://github.com/motdotla/dotenv.git"},us="https://dotenvx.com",hs=["dotenv","env",".env","environment","variables","config","settings"],ls="README.md",ds="BSD-2-Clause",ps={"@definitelytyped/dtslint":"^0.0.133","@types/node":"^18.11.3",decache:"^4.6.1",sinon:"^14.0.1",standard:"^17.0.0","standard-markdown":"^7.1.0","standard-version":"^9.5.0",tap:"^16.3.0",tar:"^6.1.11",typescript:"^4.8.4"},ms={node:">=12"},fs={fs:!1},gs={name:ts,version:rs,description:ss,main:ns,types:is,exports:os,scripts:as,repository:cs,funding:us,keywords:hs,readmeFilename:ls,license:ds,devDependencies:ps,engines:ms,browser:fs};var Z={};const be=es,Ie=wt,ys=_t,Cs=bt,ws=gs,ke=ws.version,_s=/(?:^|^)\s*(?:export\s+)?([\w.-]+)(?:\s*=\s*?|:\s+?)(\s*'(?:\\'|[^'])*'|\s*"(?:\\"|[^"])*"|\s*`(?:\\`|[^`])*`|[^#\r\n]+)?\s*(?:#.*)?(?:$|$)/mg;function bs(s){const e={};let t=s.toString();t=t.replace(/\r\n?/mg,`
`);let r;for(;(r=_s.exec(t))!=null;){const n=r[1];let i=r[2]||"";i=i.trim();const o=i[0];i=i.replace(/^(['"`])([\s\S]*)\1$/mg,"$2"),o==='"'&&(i=i.replace(/\\n/g,`
`),i=i.replace(/\\r/g,"\r")),e[n]=i}return e}function vs(s){const e=ht(s),t=_.configDotenv({path:e});if(!t.parsed){const o=new Error(`MISSING_DATA: Cannot parse ${e} for an unknown reason`);throw o.code="MISSING_DATA",o}const r=ut(s).split(","),n=r.length;let i;for(let o=0;o<n;o++)try{const c=r[o].trim(),u=Ts(t,c);i=_.decrypt(u.ciphertext,u.key);break}catch(c){if(o+1>=n)throw c}return _.parse(i)}function Is(s){console.log(`[dotenv@${ke}][INFO] ${s}`)}function ks(s){console.log(`[dotenv@${ke}][WARN] ${s}`)}function oe(s){console.log(`[dotenv@${ke}][DEBUG] ${s}`)}function ut(s){return s&&s.DOTENV_KEY&&s.DOTENV_KEY.length>0?s.DOTENV_KEY:Z.DOTENV_KEY&&Z.DOTENV_KEY.length>0?Z.DOTENV_KEY:""}function Ts(s,e){let t;try{t=new URL(e)}catch(c){if(c.code==="ERR_INVALID_URL"){const u=new Error("INVALID_DOTENV_KEY: Wrong format. Must be in valid uri format like dotenv://:key_1234@dotenvx.com/vault/.env.vault?environment=development");throw u.code="INVALID_DOTENV_KEY",u}throw c}const r=t.password;if(!r){const c=new Error("INVALID_DOTENV_KEY: Missing key part");throw c.code="INVALID_DOTENV_KEY",c}const n=t.searchParams.get("environment");if(!n){const c=new Error("INVALID_DOTENV_KEY: Missing environment part");throw c.code="INVALID_DOTENV_KEY",c}const i=`DOTENV_VAULT_${n.toUpperCase()}`,o=s.parsed[i];if(!o){const c=new Error(`NOT_FOUND_DOTENV_ENVIRONMENT: Cannot locate environment ${i} in your .env.vault file.`);throw c.code="NOT_FOUND_DOTENV_ENVIRONMENT",c}return{ciphertext:o,key:r}}function ht(s){let e=null;if(s&&s.path&&s.path.length>0)if(Array.isArray(s.path))for(const t of s.path)be.existsSync(t)&&(e=t.endsWith(".vault")?t:`${t}.vault`);else e=s.path.endsWith(".vault")?s.path:`${s.path}.vault`;else e=Ie.resolve(process.cwd(),".env.vault");return be.existsSync(e)?e:null}function Ge(s){return s[0]==="~"?Ie.join(ys.homedir(),s.slice(1)):s}function Ms(s){Is("Loading env from encrypted .env.vault");const e=_._parseVault(s);let t=Z;return s&&s.processEnv!=null&&(t=s.processEnv),_.populate(t,e,s),{parsed:e}}function Ss(s){const e=Ie.resolve(process.cwd(),".env");let t="utf8";const r=!!(s&&s.debug);s&&s.encoding?t=s.encoding:r&&oe("No encoding is specified. UTF-8 is used by default");let n=[e];if(s&&s.path)if(!Array.isArray(s.path))n=[Ge(s.path)];else{n=[];for(const u of s.path)n.push(Ge(u))}let i;const o={};for(const u of n)try{const l=_.parse(be.readFileSync(u,{encoding:t}));_.populate(o,l,s)}catch(l){r&&oe(`Failed to load ${u} ${l.message}`),i=l}let c=Z;return s&&s.processEnv!=null&&(c=s.processEnv),_.populate(c,o,s),i?{parsed:o,error:i}:{parsed:o}}function Es(s){if(ut(s).length===0)return _.configDotenv(s);const e=ht(s);return e?_._configVault(s):(ks(`You set DOTENV_KEY but you are missing a .env.vault file at ${e}. Did you forget to build it?`),_.configDotenv(s))}function As(s,e){const t=Buffer.from(e.slice(-64),"hex");let r=Buffer.from(s,"base64");const n=r.subarray(0,12),i=r.subarray(-16);r=r.subarray(12,-16);try{const o=Cs.createDecipheriv("aes-256-gcm",t,n);return o.setAuthTag(i),`${o.update(r)}${o.final()}`}catch(o){const c=o instanceof RangeError,u=o.message==="Invalid key length",l=o.message==="Unsupported state or unable to authenticate data";if(c||u){const h=new Error("INVALID_DOTENV_KEY: It must be 64 characters long (or more)");throw h.code="INVALID_DOTENV_KEY",h}else if(l){const h=new Error("DECRYPTION_FAILED: Please check your DOTENV_KEY");throw h.code="DECRYPTION_FAILED",h}else throw o}}function Fs(s,e,t={}){const r=!!(t&&t.debug),n=!!(t&&t.override);if(typeof e!="object"){const i=new Error("OBJECT_REQUIRED: Please check the processEnv argument being passed to populate");throw i.code="OBJECT_REQUIRED",i}for(const i of Object.keys(e))Object.prototype.hasOwnProperty.call(s,i)?(n===!0&&(s[i]=e[i]),r&&oe(n===!0?`"${i}" is already defined and WAS overwritten`:`"${i}" is already defined and was NOT overwritten`)):s[i]=e[i]}const _={configDotenv:Ss,_configVault:Ms,_parseVault:vs,config:Es,decrypt:As,parse:bs,populate:Fs};A.exports.configDotenv=_.configDotenv;A.exports._configVault=_._configVault;A.exports._parseVault=_._parseVault;A.exports.config=_.config;A.exports.decrypt=_.decrypt;A.exports.parse=_.parse;A.exports.populate=_.populate;A.exports=_;var Rs=A.exports;const Ps=Kr(Rs),B={START_OPTIONS:{BREAKING_BAD:"Давай во все тяжкие!",NOT_SHURE:"Не уверен"},QUESTIONS_OPTIONS:{BASE:"Основы тестирования",PROCESS:"Процессы и методологии",TECHICAL:"Инструменты и технологии",EXPERTISE:"Личные качества и опыт"}},ae={GREETINGS:`Привет! Я QA Interview Bot 🤖 
Я помогу пройти ассессмент QA в стриме ITSM 
Хорошо подготовились?`,QUESTION_SELECTION:"Сейчас проверим. Выбери тему вопроса в меню 👇🏻",LETS_START:"Итак, поговорим про ",RIGHT_ANSWER:"Верно!",WRONG_ANSWER:"Не верно!",SPECIFIC:"Вижу, у Вас специфические вкусы"},z={TOKEN_IS_NOT_DEFINED:"Ошибка получения токена из переменной окружения",UPDATE:"Ошибка при обработке обновления",REQUEST:"Ошибка в запросе:",HTTP:"Не удалось установить соединение с Telegram:",UNKNOWN:"Неизвестная ошибка:"};var Ns={};Ps.config();function xs(){const s=Ns.TOKEN;if(!s)throw new Error(z.TOKEN_IS_NOT_DEFINED);return s}const Os=[{id:1,text:"Какой из следующих типов тестирования выполняется без доступа к исходному коду?",options:[{id:1,text:"Белый ящик",isCorrect:!1},{id:2,text:"Черный ящик",isCorrect:!0},{id:3,text:"Серый ящик",isCorrect:!1},{id:4,text:"Интеграционное тестирование",isCorrect:!1}]},{id:2,text:"Что такое регрессионное тестирование?",options:[{id:1,text:"Тестирование новых функций",isCorrect:!1},{id:2,text:"Тестирование исправлений и изменений",isCorrect:!0},{id:3,text:"Тестирование производительности",isCorrect:!1},{id:4,text:"Тестирование на совместимость",isCorrect:!1}]},{id:3,text:"Какой из следующих методов тестирования является наиболее подходящим для проверки пользовательского интерфейса?",options:[{id:1,text:"Модульное тестирование.",isCorrect:!1},{id:2,text:"Интеграционное тестирование.",isCorrect:!1},{id:3,text:"Системное тестирование.",isCorrect:!0},{id:4,text:"Тестирование безопасности.",isCorrect:!1}]},{id:4,text:"Какой из следующих методов тестирования наиболее подходит для проверки корректности работы системы в условиях различных конфигураций оборудования?",options:[{id:1,text:"Модульное тестирование.",isCorrect:!1},{id:2,text:"Интеграционное тестирование.",isCorrect:!1},{id:3,text:"Системное тестирование.",isCorrect:!0},{id:4,text:"Тестирование безопасности.",isCorrect:!1}]},{id:3,text:"Какой тип тестирования проводится для проверки соответствия системы требованиям заказчика?",options:[{id:1,text:"Модульное тестирование",isCorrect:!1},{id:2,text:"Интеграционное тестирование",isCorrect:!1},{id:3,text:"Системное тестирование",isCorrect:!1},{id:4,text:"Приемочное тестирование",isCorrect:!0}]}],Ls=[{id:1,text:"Какой из следующих подходов к тестированию лучше всего подходит для Agile-разработки?",options:[{id:1,text:"Водопадная модель",isCorrect:!1},{id:2,text:"Модель V",isCorrect:!1},{id:3,text:"Тестирование на основе рисков",isCorrect:!0},{id:4,text:"Модель спирали",isCorrect:!1}]},{id:2,text:"Что означает аббревиатура SDLC в контексте разработки программного обеспечения?",options:[{id:1,text:"Цикл жизни разработки программного обеспечения",isCorrect:!0},{id:2,text:"Цикл жизни проектирования системы",isCorrect:!1},{id:3,text:"Цикл жизни развертывания программного обеспечения",isCorrect:!1},{id:4,text:"Цикл жизни разработки системы",isCorrect:!1}]},{id:3,text:"Что такое 'пирамида тестирования' и какую роль она играет в эффективном тестировании?",options:[{id:1,text:"Это модель, которая показывает соотношение различных типов тестов и помогает определить приоритеты и баланс между ними",isCorrect:!0},{id:2,text:"Это модель, которая описывает последовательность выполнения различных типов тестов",isCorrect:!1},{id:3,text:"Это модель, которая определяет, какие типы тестов должны выполняться на каждом этапе разработки",isCorrect:!1},{id:4,text:"Это модель, которая показывает, как различные типы тестов взаимодействуют друг с другом",isCorrect:!1}]}],Ds=[{id:1,text:"Что такое 'окружения' (Environments) в Postman и для чего они используются?",options:[{id:1,text:"Окружения позволяют создавать и управлять коллекциями запросов.",isCorrect:!1},{id:2,text:"Окружения позволяют хранить и управлять переменными, которые могут быть использованы в запросах и тестах.",isCorrect:!0},{id:3,text:"Окружения позволяют автоматизировать выполнение запросов.",isCorrect:!1},{id:4,text:"Окружения позволяют создавать и управлять документацией API.",isCorrect:!1}]},{id:2,text:"Какие виды JOIN существуют в SQL?",options:[{id:1,text:"INNER JOIN, LEFT JOIN, RIGHT JOIN, FULL JOIN",isCorrect:!0},{id:2,text:"INNER JOIN, LEFT JOIN, RIGHT JOIN, CROSS JOIN",isCorrect:!1},{id:3,text:"INNER JOIN, LEFT JOIN, RIGHT JOIN, SELF JOIN",isCorrect:!1},{id:4,text:"INNER JOIN, LEFT JOIN, RIGHT JOIN, OUTER JOIN",isCorrect:!1}]},{id:3,text:"Что такое 'заголовки' (Headers) в HTTP и для чего они используются?",options:[{id:1,text:"Заголовки используются для передачи данных между клиентом и сервером, которые не являются частью тела сообщения.",isCorrect:!0},{id:2,text:"Заголовки используются только для передачи данных о типе контента.",isCorrect:!1},{id:3,text:"Заголовки используются только для передачи данных о статусе ответа сервера.",isCorrect:!1},{id:4,text:"Заголовки используются только для передачи данных о времени выполнения запроса.",isCorrect:!1}]}],js=[{id:1,text:"Что делать, если найденный вами баг не воспроизводится у разработчика?",options:[{id:1,text:"Закрыть баг как невоспроизводимый",isCorrect:!1},{id:2,text:"Попросить разработчика попробовать на другой машине",isCorrect:!1},{id:3,text:"Предоставить разработчику подробную информацию о шагах воспроизведения, окружении и логах",isCorrect:!0},{id:4,text:"Проигнорировать баг и перейти к следующему",isCorrect:!1}]},{id:2,text:"Как лучше поступить, если найденный вами баг критический, но его исправление может задержать релиз?",options:[{id:1,text:"Закрыть баг как некритический",isCorrect:!1},{id:2,text:"Обсудить с командой возможность отложить релиз",isCorrect:!0},{id:3,text:"Проигнорировать баг и выпустить релиз",isCorrect:!1},{id:4,text:"Попросить разработчика быстро исправить баг",isCorrect:!1}]},{id:4,text:"Как лучше поступить, если найденный вами баг не воспроизводится на тестовом окружении, но воспроизводится на продовом?",options:[{id:1,text:"Закрыть баг как невоспроизводимый",isCorrect:!1},{id:2,text:"Попросить разработчика воспроизвести баг на продовом окружении",isCorrect:!1},{id:3,text:"Предоставить разработчику информацию о различиях между тестовым и продовым окружением",isCorrect:!0},{id:4,text:"Проигнорировать баг и перейти к следующему",isCorrect:!1}]},{id:5,text:"Что делать, если найденный вами баг не воспроизводится после обновления версии приложения?",options:[{id:1,text:"Закрыть баг как невоспроизводимый",isCorrect:!0},{id:2,text:"Попросить разработчика воспроизвести баг на старой версии",isCorrect:!1},{id:3,text:"Зарегистрировать новый баг с теми же шагами воспроизведения",isCorrect:!1},{id:4,text:"Проигнорировать баг и перейти к следующему",isCorrect:!1}]}],$s={base:Os,process:Ls,technical:Ds,expertise:js},Be=$s;function Qs(s){const e=Math.floor(Math.random()*Be[s].length);return Be[s][e]}function Us(s){switch(!0){case s===B.QUESTIONS_OPTIONS.PROCESS:return"process";case s===B.QUESTIONS_OPTIONS.TECHICAL:return"technical";case s===B.QUESTIONS_OPTIONS.EXPERTISE:return"expertise";default:return"base"}}const{BASE:lt,PROCESS:dt,TECHICAL:pt,EXPERTISE:mt}=B.QUESTIONS_OPTIONS,Y=new Jr(xs());Y.command("start",async s=>{const e=new w().text(B.START_OPTIONS.BREAKING_BAD,"breakingBad").text(B.START_OPTIONS.NOT_SHURE,"notShure");await s.reply(ae.GREETINGS,{reply_markup:e})});Y.callbackQuery(["breakingBad","notShure"],async s=>{const e=new I().text(lt).text(dt).row().text(pt).text(mt).resized();await s.reply(ae.QUESTION_SELECTION,{reply_markup:e})});Y.hears([lt,dt,pt,mt],async s=>{var i;const e=Us(((i=s.message)==null?void 0:i.text)??"base"),t=Qs(e??"base"),r=t.options.map(o=>[w.text(o.text,JSON.stringify({isCorrect:o.isCorrect}))]),n=w.from(r);await s.reply(t.text,{reply_markup:n})});Y.on("callback_query:data",async s=>{JSON.parse(s.callbackQuery.data).isCorrect?await s.answerCallbackQuery({text:ae.RIGHT_ANSWER}):await s.answerCallbackQuery({text:ae.WRONG_ANSWER,show_alert:!0})});Y.catch(s=>{const e=s.ctx;console.error(`${z.UPDATE} ${e.update.update_id}:`);const t=s.error;t instanceof ce?console.error(z.REQUEST,t.description):t instanceof ve?console.error(z.HTTP,t):console.error(z.UNKNOWN,t)});Y.start();
